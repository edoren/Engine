set(ENGINE_RENDER_DIR "${ENGINE_SOURCE_DIR}/Renderer")
set(ENGINE_MATH_DIR "${ENGINE_SOURCE_DIR}/Math")
set(ENGINE_GRAPHICS_DIR "${ENGINE_SOURCE_DIR}/Graphics")
set(ENGINE_INPUT_DIR "${ENGINE_SOURCE_DIR}/Input")
set(ENGINE_SYSTEM_DIR "${ENGINE_SOURCE_DIR}/System")
set(ENGINE_UTIL_DIR "${ENGINE_SOURCE_DIR}/Util")

file(GLOB_RECURSE ENGINE_RENDER_SRC "${ENGINE_RENDER_DIR}/*.cpp" "${ENGINE_RENDER_DIR}/*.hpp")
file(GLOB_RECURSE ENGINE_MATH_SRC "${ENGINE_MATH_DIR}/*.cpp" "${ENGINE_MATH_DIR}/*.hpp")
file(GLOB_RECURSE ENGINE_GRAPHICS_SRC "${ENGINE_GRAPHICS_DIR}/*.cpp" "${ENGINE_GRAPHICS_DIR}/*.hpp")
file(GLOB_RECURSE ENGINE_INPUT_SRC "${ENGINE_INPUT_DIR}/*.cpp" "${ENGINE_INPUT_DIR}/*.hpp")
file(GLOB_RECURSE ENGINE_SYSTEM_SRC "${ENGINE_SYSTEM_DIR}/*.cpp" "${ENGINE_SYSTEM_DIR}/*.hpp")
file(GLOB_RECURSE ENGINE_UTIL_SRC "${ENGINE_UTIL_DIR}/*.cpp" "${ENGINE_UTIL_DIR}/*.hpp")

set(ENGINE_SRCS
    ${ENGINE_RENDER_SRC}
    ${ENGINE_MATH_SRC}
    ${ENGINE_GRAPHICS_SRC}
    ${ENGINE_INPUT_SRC}
    ${ENGINE_SYSTEM_SRC}
    ${ENGINE_UTIL_SRC}
)

add_library(${ENGINE_NAME} ${ENGINE_SRCS})

foreach(FILE ${ENGINE_SRCS})
    get_filename_component(FILE_EXTENSION "${FILE}" EXT)
    get_filename_component(FILE_DIRECTORY "${FILE}" DIRECTORY)
    file(RELATIVE_PATH FILE_RELATIVE_DIR ${ENGINE_SOURCE_DIR} ${FILE_DIRECTORY})

    string(REPLACE "/" "\\" FILTER ${FILE_RELATIVE_DIR})
    if(${FILE_EXTENSION} STREQUAL ".c" OR ${FILE_EXTENSION} STREQUAL ".cpp")
        set(FILTER "Source Files\\${FILTER}")
    elseif(${FILE_EXTENSION} STREQUAL ".h" OR ${FILE_EXTENSION} STREQUAL ".hpp")
        set(FILTER "Header Files\\${FILTER}")
    endif()

    source_group(${FILTER} FILES ${FILE})
endforeach()

target_link_libraries(${ENGINE_NAME}
    ${OPENGL_LIBRARIES}
    ${SDL2_LIBRARIES}
    ${GLEW_LIBRARIES}
)
